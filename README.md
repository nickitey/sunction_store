## Автоматизированная обработка данных для магазина оптики

#### Введение.
Основной задачей, облегчить которую призвано данное python-based решение, является обработка данных о моделях солнцезащитных очков и оптических оправ,предоставляемых поставщиками и дилерами данной продукции, и преобразование ее в информационную модель, пригодную для заполнения на ее основе ассортимента интернет-магазина конечного продавца.

Данные предоставляются в виде таблиц формата .xlsx или .csv. Некоторые данные собираются автоматизированно, путем скраппинга сайта производителя и постащика.

Ключевая трудность, которая возникла в ходе решения задачи автоматизации ручного труда - отсутствие унификации исходных данных. Информация в автоматическом режиме собирается _as is_, и в некоторых случах в ней отсутствуют какие-то критически важные составляющие вроде артикула модели.

Предпосылки к разработке единого инструмента появились еще на этапе ручной обработки многих таблиц, когда встал вопрос работы с массивами, а встроенная в Excel функция _=ВПР(VLOOKUP)_ по каким-то причинам не отвечала предъявляемым требованиям[^1]

[^1]: Например, если есть 100 уникальных текстовых фрагментов маркетингового "продающего" текста, которые необходимо сопоставить 600 моделям очков. Функция _=ВПР_ в этом случае бессильна ввиду ограничения на 256 символов искомого текстового фрагмнета.

Полноценная разработка стартовала в процессе обработки таблицы, в которой фактически не было никаких данных кроме некого абстрактного текстового фрагмента, не без труда разбиваемого на артикулы модели и цвета, цены позиции и ссылки на изображение на Яндекс.Диске.

После этого в один модуль были собраны все имеющиеся наработки, которые могли бы помочь оптимизировать решение поставленной задачи заполнения итоговой таблицы данными соответствующего формата.

#### Общее описание:

Как уже было сказано, ввиду отсутствия общих паттернов построения стартовых данных какая-либо общая конечная конструкция программы либо модели данных в данном случае маловероятна. Инкапсуляция в классах в данном случае также малополезна, в связи с чем принято решение оставить общую модульную "функциональную" структуру проекта, соблюдая один из принципов SOLID: одна функция - одна задача.

Соответственно, итоговая программа-обработчик пока еще вручную "конструируется" из фрагментов, исходя из поставленной задачи в соответствии с предоставленным функционалом.

Основным модулем, хранящим общие функции, является модуль __main.py__.

Останавливаться на описании каждой функции необходимости нет, поскольку, ввиду отсутствия сложных взаимосвязей между модулями и разными классами, как это бывает в больших готовых проектах, предполагается, что пользователь имеет доступ непосредственно к каталогу доступных функций, каждая из которых снабжена подробным _docstring_.

Для работы с файлами .xlsx используется библиотека pandas, предоставляющая весьма удобный функционал преобразования и представления данных внутри файла в различные типы данных python. 

Широко используются возможности стандартной библиотеки языка python, в частности в модуле _links_collector.py_ решается задача сбора относительных ссылок на фотографии очков, размещенных локально, с переименованием файлов непосредственно на компьютере для удаления из адреса файла недопустимых символов[^2].

[^2]: Данные, поступающие на обработку, могут быть очень и очень "грязными", например, некоторые имена файлов содержат символ "#", который, являясь частью URL, воспринимается как адресация браузера по "якорной" ссылке на раздел несуществующей страницы.

Часть представленных на обработку фотографий была в форматах, отличных от JPEG, в связи с чем в модуле появилась функция-конвертер[^3].

[^3]: Использует модули Pillow и Pillow-heif.

Модуль _link_checker.py_ осуществляет проверку готовых ссылок на размещенные на хостинге интернет-магазина фотографии очков и собирает данные о неработающих ссылках в отдельные файлы по ракурсам.

Модули _sku.py_[^4] и _sizes.py_[^5] нуждаются в ревизии и пересмотре их для встраивания в общую систему функций программы, однако выполняемые ими задачи достаточно тривиальны, в связи с чем, пока не будет определено уверенное направление на концепцию "программа полного цикла обработки данных" возможно является целесообразным решение этих задач средствами Excel. Хотя, конечно, в вопросе удобства обобщенные программные решения выигрывают ввиду громоздкости и слабой читаемости формул Excel, а также отсутствия необходимого функционала в разных версиях программ для работы с такими файлами (Microsoft Excel, LibreOffice Calc и др.).

[^4]: Составление складского идентификационного номера из артикула с удалением всех пробелов и размера конкретной позиции очков.

[^5]: Обработка информации о размерах очков в нескольких измерениях с удалением обозначения единицы измерения и приведением к типу данных _float_.

Проект находится в активной стадии разработки, итоговая цель видится как создание готового комплексного программног продукта, включающего в себя скраппер "сырых" данных в необходимой для проекта структуре и все следующие по цепочке обработчики данных для получения на выходе готовой таблицы.
